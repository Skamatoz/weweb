{"cacheVersion":157,"page":{"id":"deddfb9d-efdf-400a-b37b-37e8945b07df","paths":{"en":"telegram","default":"telegram"},"cmsDataSetPath":null,"workflows":[]},"sections":{"afa25bc9-d157-44ae-93c8-c00d27c22727":{"uid":"afa25bc9-d157-44ae-93c8-c00d27c22727","linkId":"99fb81b3-7bbc-4b2c-8330-2b75783372fb","_state":{"style":{"default":{}}},"content":{"mobile":{"_ww-layout_alignItems":"center","_ww-layout_justifyContent":"center"},"default":{"wwObjects":[{"uid":"1190916c-8d89-487d-bbc6-a63ff31976a5","isWwObject":true},{"uid":"7f969b86-5ade-489b-a35f-e7b82eb8ba55","isWwObject":true}],"_ww-layout_alignItems":"center","_ww-layout_flexDirection":"column","_ww-layout_justifyContent":"center"}},"sectionBaseId":"99586bd3-2b15-4d6b-a025-6a50d07ca845","sectionTitle":"Section"}},"wwObjects":{"1190916c-8d89-487d-bbc6-a63ff31976a5":{"uid":"1190916c-8d89-487d-bbc6-a63ff31976a5","_state":{"style":{"mobile":{"height":"150px","aspectRatio":"unset"},"default":{}}},"content":{"default":{"children":[{"uid":"a5487356-3468-4c72-aa17-17de33d56009","isWwObject":true}],"_ww-layout_alignItems":"flex-start","_ww-layout_flexDirection":"column"}},"name":null,"wwObjectBaseId":"b783dc65-d528-4f74-8c14-e27c934c39b1","libraryComponentBaseId":null,"parentSectionId":"afa25bc9-d157-44ae-93c8-c00d27c22727"},"a5487356-3468-4c72-aa17-17de33d56009":{"uid":"a5487356-3468-4c72-aa17-17de33d56009","_state":{"style":{"default":{}}},"content":{"tablet":{},"default":{"tag":"p","bgColor":"","shadows":"","fontStyle":"ww-font-style-text","textColor":"","globalStyle":{},"_ww-text_text":{"en":{"__wwtype":"f","defaultValue":"<p>This is some text</p>"}},"transformation":"","_ww-text_ellipsis":false,"_ww-text_fontSize":"16px","_ww-text_sanitize":false}},"name":null,"wwObjectBaseId":"d7904e9d-fc9a-4d80-9e32-728e097879ad","libraryComponentBaseId":null,"parentSectionId":"afa25bc9-d157-44ae-93c8-c00d27c22727"},"7f969b86-5ade-489b-a35f-e7b82eb8ba55":{"uid":"7f969b86-5ade-489b-a35f-e7b82eb8ba55","_state":{"style":{"mobile":{"align":"center","width":"auto","textAlign":"center"}},"interactions":[{"id":"322fb071-514c-48ab-b0a9-a2e7f8f38a0d","actions":{"b0f63f48-f027-434f-9e14-406749a6bfcd":{"id":"b0f63f48-f027-434f-9e14-406749a6bfcd","code":";(function(){\n  // флаг «мы уже отработали»\n  let _alreadyFetched = false;\n\n  // 1) Коллбек, который Telegram вызовет после логина\n  window.onTelegramAuth = function(user) {\n    // если уже делали fetch — выходим\n    if (_alreadyFetched) return;\n    _alreadyFetched = true;\n\n    // Сохраняем данные пользователя\n    localStorage.setItem('telegramUser', JSON.stringify(user));\n\n    // Шлём один fetch и ждём токен\n    fetch('https://x8ki-letl-twmt.n7.xano.io/api:Lj5PwYWo/telegram', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        telegram_id: user.id,\n        first_name:  user.first_name,\n        last_name:   user.last_name   || '',\n        username:    user.username    || '',\n        photo_url:   user.photo_url   || '',\n        hash:         user.hash\n      })\n    })\n    .then(res => res.json())\n    .then(data => {\n    localStorage.setItem('token', data.authToken);\n    window.location.href = '/';\n    })\n    .catch(err => console.error('Ошибка авторизации:', err));\n  };\n\n  // 2) Динамически вставляем виджет в #tg-login\n  const container = document.getElementById('tg-login');\n  if (!container) return;\n  const tg = document.createElement('script');\n  tg.async = true;\n  tg.src = 'https://telegram.org/js/telegram-widget.js?22';\n  tg.setAttribute('data-telegram-login', 'diana730bot');\n  tg.setAttribute('data-size', 'large');\n  tg.setAttribute('data-onauth', 'onTelegramAuth(user)');\n  tg.setAttribute('data-request-access', 'write');\n  container.appendChild(tg);\n\n})();","name":"Авторизация ТГ на html блоке","type":"custom-js"}},"trigger":"_wwOnMounted","firstAction":"b0f63f48-f027-434f-9e14-406749a6bfcd","triggerConditions":null}]},"content":{"default":{"source":"<div id=\"tg-login\"></div>\n","refreshOnResize":false}},"name":null,"wwObjectBaseId":"6d692ca2-6cdc-4805-aa0c-211102f335d0","libraryComponentBaseId":null,"parentSectionId":"afa25bc9-d157-44ae-93c8-c00d27c22727"}},"collections":[],"variables":[],"workflows":[],"formulas":[],"libraryComponents":[]}